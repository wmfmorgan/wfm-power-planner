{# templates/calendar/day.html — FINAL PERFECTION — SIDEBAR WITH PERFECT BREATHING ROOM #}
<div class="max-w-7xl mx-auto">
  <h2 class="text-6xl font-black text-gold mb-8 text-center drop-shadow-lg">
    {{ month|month_name }} {{ day }}, {{ year }}
  </h2>

  <!-- MAIN GRID — 3:1 RATIO, CLEAN GAP -->
  <div class="mt-20 grid grid-cols-1 md:grid-cols-4 gap-8">
    
    <!-- LEFT: TIME GRID -->
    <div class="md:col-span-3">
      <div class="grid grid-cols-12 gap-0 border-4 border-yellow-400 rounded-xl overflow-hidden shadow-heavy bg-black">
        <!-- TIME LABELS -->
        <div class="col-span-1 bg-dark">
          {% for slot in range(38) %}
            {% set hour = 5 + (slot // 2) %}
            {% set minute = (slot % 2) * 30 %}
            {% set hour_12 = ((hour - 1) % 12) + 1 %}
            {% set am_pm = 'AM' if hour < 12 else 'PM' %}

            <div class="h-32 border-b border-gray-700 flex items-center justify-end pr-5">
              {% if minute == 0 %}
                <span class="text-gold text-lg">{{ "%d:00"|format(hour_12) }}</span>
                <span class="text-gold text-sm ml-2">{{ am_pm }}</span>
              {% else %}
                <span class="text-gray-500 text-lg">{{ "%d:%02d"|format(hour_12, minute) }}</span>
              {% endif %}
            </div>
          {% endfor %}
        </div>

        <!-- TIME SLOTS -->
        <div class="col-span-11 bg-gray-950">
          <div class="grid grid-rows-38 h-full">
            {% for slot in range(38) %}
              {% set hour = 5 + (slot // 2) %}
              {% set minute = (slot % 2) * 30 %}
              {% set hour_12 = ((hour - 1) % 12) + 1 %}
              {% set am_pm = 'AM' if hour < 12 else 'PM' %}

              <div class="border-b border-gray-700 relative group cursor-pointer">
                <div class="absolute inset-0 hover:bg-yellow-900/30 transition-all"></div>
                <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none">
                  <span class="text-2xl font-black text-gold drop-shadow-lg">
                    {{ "%d:%02d %s"|format(hour_12, minute, am_pm) }}
                  </span>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT: SIDEBAR — NOW WITH PERFECT BREATHING ROOM -->
    <div class="md:col-span-1 flex flex-col gap-12">  <!-- THIS gap-12 IS THE SECRET SAUCE -->
      
      <!-- TODAY'S GOALS -->
      <div class="bg-dark border-4 border-cyan-500 rounded-2xl pad-lg shadow-heavy flex flex-col">
        <h3 class="text-3xl font-black text-cyan-400 mb-4 text-center">TODAY'S GOALS</h3>
        <div id="today-goals-kanban" class="flex-1 overflow-y-auto px-4">
          <p class="text-gray-500 text-center mt-8">Loading today's goals...</p>
        </div>
      </div>

      <!-- TODAY'S TASKS -->
      <div class="bg-dark border-4 border-orange-500 rounded-2xl pad-lg shadow-heavy flex flex-col">
        <h3 class="text-3xl font-black text-orange-400 mb-4 text-center">TODAY'S TASKS</h3>
        <div id="today-tasks-kanban" class="flex-1 overflow-y-auto px-4">
          <p class="text-gray-500 text-center mt-8">Loading today's tasks...</p>
        </div>
      </div>
    </div>
  </div>

</div>